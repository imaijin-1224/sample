{% extends 'myapp/base.html' %}

{% block title %}日記詳細 - AI習慣形成サポーター{% endblock %}

<!-- 日記詳細画面 -->

{% block content %}
<!-- ヘッダー（ページタイトル・戻るボタンなど） -->
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">
        <i class="fas fa-book me-2"></i>日記詳細
    </h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <a href="{% url 'myapp:diary_list' %}" class="btn btn-outline-secondary me-2">
            <i class="fas fa-arrow-left me-1"></i>一覧に戻る
        </a>
        <a href="{% url 'myapp:diary_create' %}" class="btn btn-primary">
            <i class="fas fa-edit me-1"></i>編集
        </a>
    </div>
</div>

<!-- 日記詳細カード・気分/エネルギー分析・次のステップなど -->
<div class="row justify-content-center">
    <div class="col-md-8">
        <!-- 日記詳細カード -->
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-calendar me-2"></i>{{ diary.date|date:"Y年m月d日" }}
                    </h5>
                    <div>
                        <span class="badge bg-primary me-2">
                            <i class="fas fa-heart me-1"></i>気分: {{ diary.mood_score }}/10
                        </span>
                        <span class="badge bg-warning">
                            <i class="fas fa-bolt me-1"></i>エネルギー: {{ diary.energy_level }}/10
                        </span>
                    </div>
                </div>
            </div>
            <div class="card-body">
                {% if diary.content %}
                    <div class="mb-4">
                        <h6><i class="fas fa-pen text-primary me-2"></i>今日の出来事・感想</h6>
                        <div class="p-3 bg-light rounded">
                            {{ diary.content|linebreaks }}
                        </div>
                    </div>
                {% else %}
                    <div class="mb-4">
                        <h6><i class="fas fa-pen text-primary me-2"></i>今日の出来事・感想</h6>
                        <div class="p-3 bg-light rounded text-muted">
                            内容が記録されていません
                        </div>
                    </div>
                {% endif %}
                
                {% if diary.gratitude %}
                    <div class="mb-4">
                        <h6><i class="fas fa-heart text-success me-2"></i>感謝の気持ち</h6>
                        <div class="p-3 bg-light rounded">
                            {{ diary.gratitude|linebreaks }}
                        </div>
                    </div>
                {% else %}
                    <div class="mb-4">
                        <h6><i class="fas fa-heart text-success me-2"></i>感謝の気持ち</h6>
                        <div class="p-3 bg-light rounded text-muted">
                            感謝の気持ちが記録されていません
                        </div>
                    </div>
                {% endif %}
                
                <div class="row text-center">
                    <div class="col-md-6">
                        <div class="card bg-primary text-white">
                            <div class="card-body">
                                <h3 class="card-title">{{ diary.mood_score }}</h3>
                                <p class="card-text">気分スコア</p>
                                <small>
                                    {% if diary.mood_score <= 3 %}
                                        落ち込んでいる・疲れている
                                    {% elif diary.mood_score <= 6 %}
                                        普通・安定している
                                    {% else %}
                                        良い気分・元気
                                    {% endif %}
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card bg-warning text-white">
                            <div class="card-body">
                                <h3 class="card-title">{{ diary.energy_level }}</h3>
                                <p class="card-text">エネルギーレベル</p>
                                <small>
                                    {% if diary.energy_level <= 3 %}
                                        疲れている・眠い
                                    {% elif diary.energy_level <= 6 %}
                                        普通のエネルギー
                                    {% else %}
                                        元気・やる気満々
                                    {% endif %}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <div class="d-flex justify-content-between align-items-center">
                    <small class="text-muted">
                        作成日時: {{ diary.created_at|date:"Y年m月d日 H:i" }}
                        {% if diary.updated_at != diary.created_at %}
                            <br>更新日時: {{ diary.updated_at|date:"Y年m月d日 H:i" }}
                        {% endif %}
                    </small>
                    <a href="{% url 'myapp:diary_create' %}" class="btn btn-primary">
                        <i class="fas fa-edit me-1"></i>編集
                    </a>
                </div>
            </div>
        </div>
        
        <!-- 気分・エネルギーの分析 -->
        <div class="card mt-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-chart-line me-2"></i>今日の状態分析
                </h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-heart text-danger me-2"></i>気分の分析</h6>
                        {% if diary.mood_score <= 3 %}
                            <div class="alert alert-warning">
                                <strong>気分が低めです</strong><br>
                                今日は無理をせず、心を労わる時間を作りましょう。
                                お気に入りの音楽を聴いたり、軽い散歩をしたりするのもおすすめです。
                            </div>
                        {% elif diary.mood_score <= 6 %}
                            <div class="alert alert-info">
                                <strong>安定した気分です</strong><br>
                                落ち着いた状態で、今日の目標に取り組めそうです。
                                小さな改善点を見つけて、さらに良い気分を目指しましょう。
                            </div>
                        {% else %}
                            <div class="alert alert-success">
                                <strong>素晴らしい気分です！</strong><br>
                                この良い状態を活かして、新しいことに挑戦したり、
                                重要なタスクに集中したりするのに適した日です。
                            </div>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-bolt text-warning me-2"></i>エネルギーの分析</h6>
                        {% if diary.energy_level <= 3 %}
                            <div class="alert alert-warning">
                                <strong>エネルギーが不足しています</strong><br>
                                十分な休息を取り、無理をしないようにしましょう。
                                栄養のある食事と十分な睡眠で回復を図ってください。
                            </div>
                        {% elif diary.energy_level <= 6 %}
                            <div class="alert alert-info">
                                <strong>適度なエネルギーがあります</strong><br>
                                通常の活動を行うのに適した状態です。
                                効率的に作業を進められるでしょう。
                            </div>
                        {% else %}
                            <div class="alert alert-success">
                                <strong>エネルギー満タンです！</strong><br>
                                新しい習慣を始めたり、難しいタスクに挑戦したりするのに
                                最適な状態です。この機会を活かしましょう。
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 次のステップ -->
        <div class="card mt-4">
            <div class="card-header bg-info text-white">
                <h6 class="mb-0">
                    <i class="fas fa-lightbulb me-2"></i>次のステップの提案
                </h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-arrow-right text-primary me-2"></i>今日の行動</h6>
                        <ul class="small">
                            <li>気分とエネルギーに合わせた活動を選択</li>
                            <li>小さな目標から始める</li>
                            <li>無理をしない範囲で行動する</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-calendar-plus text-success me-2"></i>明日に向けて</h6>
                        <ul class="small">
                            <li>今日の振り返りを活かす</li>
                            <li>改善点があれば明日に活かす</li>
                            <li>継続できる習慣を見つける</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
